(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();class nt{constructor(){this.dbName="UserSystemDB",this.version=1,this.db=null,this.init()}async init(){return new Promise((e,t)=>{const o=indexedDB.open(this.dbName,this.version);o.onerror=()=>t(o.error),o.onsuccess=()=>{this.db=o.result,e(this.db)},o.onupgradeneeded=r=>{const i=r.target.result;if(!i.objectStoreNames.contains("users")){const s=i.createObjectStore("users",{keyPath:"id",autoIncrement:!0});s.createIndex("email","email",{unique:!0}),s.createIndex("nome","nome",{unique:!1}),s.createIndex("cargo","cargo",{unique:!1}),s.createIndex("dataRegistro","dataRegistro",{unique:!1})}}})}async addUser(e){return new Promise((t,o)=>{const i=this.db.transaction(["users"],"readwrite").objectStore("users"),s={...e,dataRegistro:new Date().toISOString(),id:Date.now()+Math.random()},a=i.add(s);a.onsuccess=()=>t(s),a.onerror=()=>o(a.error)})}async getAllUsers(){return new Promise((e,t)=>{const i=this.db.transaction(["users"],"readonly").objectStore("users").getAll();i.onsuccess=()=>e(i.result),i.onerror=()=>t(i.error)})}async updateUser(e,t){return new Promise((o,r)=>{const s=this.db.transaction(["users"],"readwrite").objectStore("users"),a=s.get(e);a.onsuccess=()=>{const c=a.result;if(c){Object.assign(c,t);const l=s.put(c);l.onsuccess=()=>o(c),l.onerror=()=>r(l.error)}else r(new Error("User not found"))}})}async deleteUser(e){return new Promise((t,o)=>{const s=this.db.transaction(["users"],"readwrite").objectStore("users").delete(e);s.onsuccess=()=>t(!0),s.onerror=()=>o(s.error)})}async searchUsers(e){const t=await this.getAllUsers(),o=e.toLowerCase();return t.filter(r=>r.nome.toLowerCase().includes(o)||r.email.toLowerCase().includes(o)||r.cargo.toLowerCase().includes(o)||r.telefone.includes(o))}async populateInitialData(){if((await this.getAllUsers()).length>0)return;const t=[{nome:"Ana Silva Santos",email:"ana.silva@empresa.com",telefone:"(11) 99876-5432",cargo:"Desenvolvedor",foto:"https://images.pexels.com/photos/774909/pexels-photo-774909.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Carlos Eduardo Lima",email:"carlos.lima@empresa.com",telefone:"(11) 98765-4321",cargo:"Designer",foto:"https://images.pexels.com/photos/1222271/pexels-photo-1222271.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Mariana Costa Oliveira",email:"mariana.costa@empresa.com",telefone:"(11) 97654-3210",cargo:"Gerente",foto:"https://images.pexels.com/photos/1239291/pexels-photo-1239291.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"João Pedro Almeida",email:"joao.almeida@empresa.com",telefone:"(11) 96543-2109",cargo:"Analista",foto:"https://images.pexels.com/photos/1681010/pexels-photo-1681010.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Fernanda Rodrigues",email:"fernanda.rodrigues@empresa.com",telefone:"(11) 95432-1098",cargo:"Coordenador",foto:"https://images.pexels.com/photos/1130626/pexels-photo-1130626.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Rafael Santos Pereira",email:"rafael.pereira@empresa.com",telefone:"(11) 94321-0987",cargo:"Desenvolvedor",foto:"https://images.pexels.com/photos/1043471/pexels-photo-1043471.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Juliana Mendes Silva",email:"juliana.mendes@empresa.com",telefone:"(11) 93210-9876",cargo:"Designer",foto:"https://images.pexels.com/photos/1036623/pexels-photo-1036623.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Bruno Ferreira Costa",email:"bruno.ferreira@empresa.com",telefone:"(11) 92109-8765",cargo:"Diretor",foto:"https://images.pexels.com/photos/1212984/pexels-photo-1212984.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Camila Souza Lima",email:"camila.souza@empresa.com",telefone:"(11) 91098-7654",cargo:"Estagiário",foto:"https://images.pexels.com/photos/1181686/pexels-photo-1181686.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Diego Martins Oliveira",email:"diego.martins@empresa.com",telefone:"(11) 90987-6543",cargo:"Desenvolvedor",foto:"https://images.pexels.com/photos/1040880/pexels-photo-1040880.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Larissa Barbosa Santos",email:"larissa.barbosa@empresa.com",telefone:"(11) 89876-5432",cargo:"Analista",foto:"https://images.pexels.com/photos/1181424/pexels-photo-1181424.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Thiago Ribeiro Silva",email:"thiago.ribeiro@empresa.com",telefone:"(11) 88765-4321",cargo:"Gerente",foto:"https://images.pexels.com/photos/1043474/pexels-photo-1043474.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Patrícia Gomes Alves",email:"patricia.gomes@empresa.com",telefone:"(11) 87654-3210",cargo:"Designer",foto:"https://images.pexels.com/photos/1181690/pexels-photo-1181690.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Rodrigo Carvalho Lima",email:"rodrigo.carvalho@empresa.com",telefone:"(11) 86543-2109",cargo:"Coordenador",foto:"https://images.pexels.com/photos/1040881/pexels-photo-1040881.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Vanessa Torres Costa",email:"vanessa.torres@empresa.com",telefone:"(11) 85432-1098",cargo:"Desenvolvedor",foto:"https://images.pexels.com/photos/1181519/pexels-photo-1181519.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Lucas Andrade Pereira",email:"lucas.andrade@empresa.com",telefone:"(11) 84321-0987",cargo:"Estagiário",foto:"https://images.pexels.com/photos/1043473/pexels-photo-1043473.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Gabriela Nascimento",email:"gabriela.nascimento@empresa.com",telefone:"(11) 83210-9876",cargo:"Analista",foto:"https://images.pexels.com/photos/1181717/pexels-photo-1181717.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Felipe Moreira Santos",email:"felipe.moreira@empresa.com",telefone:"(11) 82109-8765",cargo:"Diretor",foto:"https://images.pexels.com/photos/1040882/pexels-photo-1040882.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Amanda Vieira Silva",email:"amanda.vieira@empresa.com",telefone:"(11) 81098-7654",cargo:"Designer",foto:"https://images.pexels.com/photos/1181562/pexels-photo-1181562.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Gustavo Fernandes Lima",email:"gustavo.fernandes@empresa.com",telefone:"(11) 80987-6543",cargo:"Desenvolvedor",foto:"https://images.pexels.com/photos/1043472/pexels-photo-1043472.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Isabela Cardoso Oliveira",email:"isabela.cardoso@empresa.com",telefone:"(11) 79876-5432",cargo:"Gerente",foto:"https://images.pexels.com/photos/1181721/pexels-photo-1181721.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Mateus Rocha Santos",email:"mateus.rocha@empresa.com",telefone:"(11) 78765-4321",cargo:"Coordenador",foto:"https://images.pexels.com/photos/1040883/pexels-photo-1040883.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Natália Campos Silva",email:"natalia.campos@empresa.com",telefone:"(11) 77654-3210",cargo:"Analista",foto:"https://images.pexels.com/photos/1181725/pexels-photo-1181725.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Pedro Henrique Costa",email:"pedro.costa@empresa.com",telefone:"(11) 76543-2109",cargo:"Desenvolvedor",foto:"https://images.pexels.com/photos/1040884/pexels-photo-1040884.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Renata Lopes Almeida",email:"renata.lopes@empresa.com",telefone:"(11) 75432-1098",cargo:"Designer",foto:"https://images.pexels.com/photos/1181729/pexels-photo-1181729.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Vinicius Dias Pereira",email:"vinicius.dias@empresa.com",telefone:"(11) 74321-0987",cargo:"Estagiário",foto:"https://images.pexels.com/photos/1040885/pexels-photo-1040885.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Beatriz Monteiro Silva",email:"beatriz.monteiro@empresa.com",telefone:"(11) 73210-9876",cargo:"Diretor",foto:"https://images.pexels.com/photos/1181733/pexels-photo-1181733.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Eduardo Pinto Santos",email:"eduardo.pinto@empresa.com",telefone:"(11) 72109-8765",cargo:"Gerente",foto:"https://images.pexels.com/photos/1040886/pexels-photo-1040886.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Letícia Freitas Lima",email:"leticia.freitas@empresa.com",telefone:"(11) 71098-7654",cargo:"Analista",foto:"https://images.pexels.com/photos/1181737/pexels-photo-1181737.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Ricardo Teixeira Costa",email:"ricardo.teixeira@empresa.com",telefone:"(11) 70987-6543",cargo:"Desenvolvedor",foto:"https://images.pexels.com/photos/1040887/pexels-photo-1040887.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Sophia Ramos Oliveira",email:"sophia.ramos@empresa.com",telefone:"(11) 69876-5432",cargo:"Coordenador",foto:"https://images.pexels.com/photos/1181741/pexels-photo-1181741.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"André Cunha Silva",email:"andre.cunha@empresa.com",telefone:"(11) 68765-4321",cargo:"Designer",foto:"https://images.pexels.com/photos/1040888/pexels-photo-1040888.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Carolina Melo Santos",email:"carolina.melo@empresa.com",telefone:"(11) 67654-3210",cargo:"Estagiário",foto:"https://images.pexels.com/photos/1181745/pexels-photo-1181745.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Henrique Azevedo Lima",email:"henrique.azevedo@empresa.com",telefone:"(11) 66543-2109",cargo:"Desenvolvedor",foto:"https://images.pexels.com/photos/1040889/pexels-photo-1040889.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Priscila Castro Costa",email:"priscila.castro@empresa.com",telefone:"(11) 65432-1098",cargo:"Analista",foto:"https://images.pexels.com/photos/1181749/pexels-photo-1181749.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Marcelo Correia Pereira",email:"marcelo.correia@empresa.com",telefone:"(11) 64321-0987",cargo:"Diretor",foto:"https://images.pexels.com/photos/1040890/pexels-photo-1040890.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Aline Batista Silva",email:"aline.batista@empresa.com",telefone:"(11) 63210-9876",cargo:"Gerente",foto:"https://images.pexels.com/photos/1181753/pexels-photo-1181753.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Daniel Macedo Santos",email:"daniel.macedo@empresa.com",telefone:"(11) 62109-8765",cargo:"Coordenador",foto:"https://images.pexels.com/photos/1040891/pexels-photo-1040891.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Tatiana Nunes Lima",email:"tatiana.nunes@empresa.com",telefone:"(11) 61098-7654",cargo:"Designer",foto:"https://images.pexels.com/photos/1181757/pexels-photo-1181757.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Fábio Moura Costa",email:"fabio.moura@empresa.com",telefone:"(11) 60987-6543",cargo:"Desenvolvedor",foto:"https://images.pexels.com/photos/1040892/pexels-photo-1040892.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Viviane Reis Oliveira",email:"viviane.reis@empresa.com",telefone:"(11) 59876-5432",cargo:"Estagiário",foto:"https://images.pexels.com/photos/1181761/pexels-photo-1181761.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Alexandre Farias Silva",email:"alexandre.farias@empresa.com",telefone:"(11) 58765-4321",cargo:"Analista",foto:"https://images.pexels.com/photos/1040893/pexels-photo-1040893.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Cristina Borges Santos",email:"cristina.borges@empresa.com",telefone:"(11) 57654-3210",cargo:"Diretor",foto:"https://images.pexels.com/photos/1181765/pexels-photo-1181765.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Roberto Siqueira Lima",email:"roberto.siqueira@empresa.com",telefone:"(11) 56543-2109",cargo:"Gerente",foto:"https://images.pexels.com/photos/1040894/pexels-photo-1040894.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Simone Vargas Costa",email:"simone.vargas@empresa.com",telefone:"(11) 55432-1098",cargo:"Coordenador",foto:"https://images.pexels.com/photos/1181769/pexels-photo-1181769.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Leandro Pacheco Pereira",email:"leandro.pacheco@empresa.com",telefone:"(11) 54321-0987",cargo:"Designer",foto:"https://images.pexels.com/photos/1040895/pexels-photo-1040895.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Mônica Tavares Silva",email:"monica.tavares@empresa.com",telefone:"(11) 53210-9876",cargo:"Desenvolvedor",foto:"https://images.pexels.com/photos/1181773/pexels-photo-1181773.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Sérgio Duarte Santos",email:"sergio.duarte@empresa.com",telefone:"(11) 52109-8765",cargo:"Estagiário",foto:"https://images.pexels.com/photos/1040896/pexels-photo-1040896.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Eliane Medeiros Lima",email:"eliane.medeiros@empresa.com",telefone:"(11) 51098-7654",cargo:"Analista",foto:"https://images.pexels.com/photos/1181777/pexels-photo-1181777.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"},{nome:"Wagner Santana Costa",email:"wagner.santana@empresa.com",telefone:"(11) 50987-6543",cargo:"Outro",foto:"https://images.pexels.com/photos/1040897/pexels-photo-1040897.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"}];for(const o of t)await this.addUser(o)}}const at="modulepreload",ct=function(n){return"/"+n},be={},lt=function(e,t,o){let r=Promise.resolve();if(t&&t.length>0){let s=function(l){return Promise.all(l.map(u=>Promise.resolve(u).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),c=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));r=s(t.map(l=>{if(l=ct(l),l in be)return;be[l]=!0;const u=l.endsWith(".css"),m=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${m}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":at,u||(d.as="script"),d.crossOrigin="",d.href=l,c&&d.setAttribute("nonce",c),document.head.appendChild(d),u)return new Promise((h,b)=>{d.addEventListener("load",h),d.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(s){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s}return r.then(s=>{for(const a of s||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};class L{constructor(e,t,o,r,i){this._legacyCanvasSize=L.DEFAULT_CANVAS_SIZE,this._preferredCamera="environment",this._maxScansPerSecond=25,this._lastScanTimestamp=-1,this._destroyed=this._flashOn=this._paused=this._active=!1,this.$video=e,this.$canvas=document.createElement("canvas"),o&&typeof o=="object"?this._onDecode=t:(console.warn(o||r||i?"You're using a deprecated version of the QrScanner constructor which will be removed in the future":"Note that the type of the scan result passed to onDecode will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),this._legacyOnDecode=t),t=typeof o=="object"?o:{},this._onDecodeError=t.onDecodeError||(typeof o=="function"?o:this._onDecodeError),this._calculateScanRegion=t.calculateScanRegion||(typeof r=="function"?r:this._calculateScanRegion),this._preferredCamera=t.preferredCamera||i||this._preferredCamera,this._legacyCanvasSize=typeof o=="number"?o:typeof r=="number"?r:this._legacyCanvasSize,this._maxScansPerSecond=t.maxScansPerSecond||this._maxScansPerSecond,this._onPlay=this._onPlay.bind(this),this._onLoadedMetaData=this._onLoadedMetaData.bind(this),this._onVisibilityChange=this._onVisibilityChange.bind(this),this._updateOverlay=this._updateOverlay.bind(this),e.disablePictureInPicture=!0,e.playsInline=!0,e.muted=!0;let s=!1;if(e.hidden&&(e.hidden=!1,s=!0),document.body.contains(e)||(document.body.appendChild(e),s=!0),o=e.parentElement,t.highlightScanRegion||t.highlightCodeOutline){if(r=!!t.overlay,this.$overlay=t.overlay||document.createElement("div"),i=this.$overlay.style,i.position="absolute",i.display="none",i.pointerEvents="none",this.$overlay.classList.add("scan-region-highlight"),!r&&t.highlightScanRegion){this.$overlay.innerHTML='<svg class="scan-region-highlight-svg" viewBox="0 0 238 238" preserveAspectRatio="none" style="position:absolute;width:100%;height:100%;left:0;top:0;fill:none;stroke:#e9b213;stroke-width:4;stroke-linecap:round;stroke-linejoin:round"><path d="M31 2H10a8 8 0 0 0-8 8v21M207 2h21a8 8 0 0 1 8 8v21m0 176v21a8 8 0 0 1-8 8h-21m-176 0H10a8 8 0 0 1-8-8v-21"/></svg>';try{this.$overlay.firstElementChild.animate({transform:["scale(.98)","scale(1.01)"]},{duration:400,iterations:1/0,direction:"alternate",easing:"ease-in-out"})}catch{}o.insertBefore(this.$overlay,this.$video.nextSibling)}t.highlightCodeOutline&&(this.$overlay.insertAdjacentHTML("beforeend",'<svg class="code-outline-highlight" preserveAspectRatio="none" style="display:none;width:100%;height:100%;fill:none;stroke:#e9b213;stroke-width:5;stroke-dasharray:25;stroke-linecap:round;stroke-linejoin:round"><polygon/></svg>'),this.$codeOutlineHighlight=this.$overlay.lastElementChild)}this._scanRegion=this._calculateScanRegion(e),requestAnimationFrame(()=>{let a=window.getComputedStyle(e);a.display==="none"&&(e.style.setProperty("display","block","important"),s=!0),a.visibility!=="visible"&&(e.style.setProperty("visibility","visible","important"),s=!0),s&&(console.warn("QrScanner has overwritten the video hiding style to avoid Safari stopping the playback."),e.style.opacity="0",e.style.width="0",e.style.height="0",this.$overlay&&this.$overlay.parentElement&&this.$overlay.parentElement.removeChild(this.$overlay),delete this.$overlay,delete this.$codeOutlineHighlight),this.$overlay&&this._updateOverlay()}),e.addEventListener("play",this._onPlay),e.addEventListener("loadedmetadata",this._onLoadedMetaData),document.addEventListener("visibilitychange",this._onVisibilityChange),window.addEventListener("resize",this._updateOverlay),this._qrEnginePromise=L.createQrEngine()}static set WORKER_PATH(e){console.warn("Setting QrScanner.WORKER_PATH is not required and not supported anymore. Have a look at the README for new setup instructions.")}static async hasCamera(){try{return!!(await L.listCameras(!1)).length}catch{return!1}}static async listCameras(e=!1){if(!navigator.mediaDevices)return[];let t=async()=>(await navigator.mediaDevices.enumerateDevices()).filter(r=>r.kind==="videoinput"),o;try{e&&(await t()).every(r=>!r.label)&&(o=await navigator.mediaDevices.getUserMedia({audio:!1,video:!0}))}catch{}try{return(await t()).map((r,i)=>({id:r.deviceId,label:r.label||(i===0?"Default Camera":`Camera ${i+1}`)}))}finally{o&&(console.warn("Call listCameras after successfully starting a QR scanner to avoid creating a temporary video stream"),L._stopVideoStream(o))}}async hasFlash(){let e;try{if(this.$video.srcObject){if(!(this.$video.srcObject instanceof MediaStream))return!1;e=this.$video.srcObject}else e=(await this._getCameraStream()).stream;return"torch"in e.getVideoTracks()[0].getSettings()}catch{return!1}finally{e&&e!==this.$video.srcObject&&(console.warn("Call hasFlash after successfully starting the scanner to avoid creating a temporary video stream"),L._stopVideoStream(e))}}isFlashOn(){return this._flashOn}async toggleFlash(){this._flashOn?await this.turnFlashOff():await this.turnFlashOn()}async turnFlashOn(){if(!this._flashOn&&!this._destroyed&&(this._flashOn=!0,this._active&&!this._paused))try{if(!await this.hasFlash())throw"No flash available";await this.$video.srcObject.getVideoTracks()[0].applyConstraints({advanced:[{torch:!0}]})}catch(e){throw this._flashOn=!1,e}}async turnFlashOff(){this._flashOn&&(this._flashOn=!1,await this._restartVideoStream())}destroy(){this.$video.removeEventListener("loadedmetadata",this._onLoadedMetaData),this.$video.removeEventListener("play",this._onPlay),document.removeEventListener("visibilitychange",this._onVisibilityChange),window.removeEventListener("resize",this._updateOverlay),this._destroyed=!0,this._flashOn=!1,this.stop(),L._postWorkerMessage(this._qrEnginePromise,"close")}async start(){if(this._destroyed)throw Error("The QR scanner can not be started as it had been destroyed.");if((!this._active||this._paused)&&(window.location.protocol!=="https:"&&console.warn("The camera stream is only accessible if the page is transferred via https."),this._active=!0,!document.hidden))if(this._paused=!1,this.$video.srcObject)await this.$video.play();else try{let{stream:e,facingMode:t}=await this._getCameraStream();!this._active||this._paused?L._stopVideoStream(e):(this._setVideoMirror(t),this.$video.srcObject=e,await this.$video.play(),this._flashOn&&(this._flashOn=!1,this.turnFlashOn().catch(()=>{})))}catch(e){if(!this._paused)throw this._active=!1,e}}stop(){this.pause(),this._active=!1}async pause(e=!1){if(this._paused=!0,!this._active)return!0;this.$video.pause(),this.$overlay&&(this.$overlay.style.display="none");let t=()=>{this.$video.srcObject instanceof MediaStream&&(L._stopVideoStream(this.$video.srcObject),this.$video.srcObject=null)};return e?(t(),!0):(await new Promise(o=>setTimeout(o,300)),this._paused?(t(),!0):!1)}async setCamera(e){e!==this._preferredCamera&&(this._preferredCamera=e,await this._restartVideoStream())}static async scanImage(e,t,o,r,i=!1,s=!1){let a,c=!1;t&&("scanRegion"in t||"qrEngine"in t||"canvas"in t||"disallowCanvasResizing"in t||"alsoTryWithoutScanRegion"in t||"returnDetailedScanResult"in t)?(a=t.scanRegion,o=t.qrEngine,r=t.canvas,i=t.disallowCanvasResizing||!1,s=t.alsoTryWithoutScanRegion||!1,c=!0):console.warn(t||o||r||i||s?"You're using a deprecated api for scanImage which will be removed in the future.":"Note that the return type of scanImage will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),t=!!o;try{let l,u;[o,l]=await Promise.all([o||L.createQrEngine(),L._loadImage(e)]),[r,u]=L._drawToCanvas(l,a,r,i);let m;if(o instanceof Worker){let d=o;t||L._postWorkerMessageSync(d,"inversionMode","both"),m=await new Promise((h,b)=>{let R,T,y,P=-1;T=p=>{p.data.id===P&&(d.removeEventListener("message",T),d.removeEventListener("error",y),clearTimeout(R),p.data.data!==null?h({data:p.data.data,cornerPoints:L._convertPoints(p.data.cornerPoints,a)}):b(L.NO_QR_CODE_FOUND))},y=p=>{d.removeEventListener("message",T),d.removeEventListener("error",y),clearTimeout(R),b("Scanner error: "+(p?p.message||p:"Unknown Error"))},d.addEventListener("message",T),d.addEventListener("error",y),R=setTimeout(()=>y("timeout"),1e4);let E=u.getImageData(0,0,r.width,r.height);P=L._postWorkerMessageSync(d,"decode",E,[E.data.buffer])})}else m=await Promise.race([new Promise((d,h)=>window.setTimeout(()=>h("Scanner error: timeout"),1e4)),(async()=>{try{var[d]=await o.detect(r);if(!d)throw L.NO_QR_CODE_FOUND;return{data:d.rawValue,cornerPoints:L._convertPoints(d.cornerPoints,a)}}catch(h){if(d=h.message||h,/not implemented|service unavailable/.test(d))return L._disableBarcodeDetector=!0,L.scanImage(e,{scanRegion:a,canvas:r,disallowCanvasResizing:i,alsoTryWithoutScanRegion:s});throw`Scanner error: ${d}`}})()]);return c?m:m.data}catch(l){if(!a||!s)throw l;let u=await L.scanImage(e,{qrEngine:o,canvas:r,disallowCanvasResizing:i});return c?u:u.data}finally{t||L._postWorkerMessage(o,"close")}}setGrayscaleWeights(e,t,o,r=!0){L._postWorkerMessage(this._qrEnginePromise,"grayscaleWeights",{red:e,green:t,blue:o,useIntegerApproximation:r})}setInversionMode(e){L._postWorkerMessage(this._qrEnginePromise,"inversionMode",e)}static async createQrEngine(e){if(e&&console.warn("Specifying a worker path is not required and not supported anymore."),e=()=>lt(()=>import("./qr-scanner-worker.min-D85Z9gVD.js"),[]).then(o=>o.createWorker()),!(!L._disableBarcodeDetector&&"BarcodeDetector"in window&&BarcodeDetector.getSupportedFormats&&(await BarcodeDetector.getSupportedFormats()).includes("qr_code")))return e();let t=navigator.userAgentData;return t&&t.brands.some(({brand:o})=>/Chromium/i.test(o))&&/mac ?OS/i.test(t.platform)&&await t.getHighEntropyValues(["architecture","platformVersion"]).then(({architecture:o,platformVersion:r})=>/arm/i.test(o||"arm")&&13<=parseInt(r||"13")).catch(()=>!0)?e():new BarcodeDetector({formats:["qr_code"]})}_onPlay(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay(),this.$overlay&&(this.$overlay.style.display=""),this._scanFrame()}_onLoadedMetaData(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay()}_onVisibilityChange(){document.hidden?this.pause():this._active&&this.start()}_calculateScanRegion(e){let t=Math.round(.6666666666666666*Math.min(e.videoWidth,e.videoHeight));return{x:Math.round((e.videoWidth-t)/2),y:Math.round((e.videoHeight-t)/2),width:t,height:t,downScaledWidth:this._legacyCanvasSize,downScaledHeight:this._legacyCanvasSize}}_updateOverlay(){requestAnimationFrame(()=>{if(this.$overlay){var e=this.$video,t=e.videoWidth,o=e.videoHeight,r=e.offsetWidth,i=e.offsetHeight,s=e.offsetLeft,a=e.offsetTop,c=window.getComputedStyle(e),l=c.objectFit,u=t/o,m=r/i;switch(l){case"none":var d=t,h=o;break;case"fill":d=r,h=i;break;default:(l==="cover"?u>m:u<m)?(h=i,d=h*u):(d=r,h=d/u),l==="scale-down"&&(d=Math.min(d,t),h=Math.min(h,o))}var[b,R]=c.objectPosition.split(" ").map((y,P)=>{const E=parseFloat(y);return y.endsWith("%")?(P?i-h:r-d)*E/100:E});c=this._scanRegion.width||t,m=this._scanRegion.height||o,l=this._scanRegion.x||0;var T=this._scanRegion.y||0;u=this.$overlay.style,u.width=`${c/t*d}px`,u.height=`${m/o*h}px`,u.top=`${a+R+T/o*h}px`,o=/scaleX\(-1\)/.test(e.style.transform),u.left=`${s+(o?r-b-d:b)+(o?t-l-c:l)/t*d}px`,u.transform=e.style.transform}})}static _convertPoints(e,t){if(!t)return e;let o=t.x||0,r=t.y||0,i=t.width&&t.downScaledWidth?t.width/t.downScaledWidth:1;t=t.height&&t.downScaledHeight?t.height/t.downScaledHeight:1;for(let s of e)s.x=s.x*i+o,s.y=s.y*t+r;return e}_scanFrame(){!this._active||this.$video.paused||this.$video.ended||("requestVideoFrameCallback"in this.$video?this.$video.requestVideoFrameCallback.bind(this.$video):requestAnimationFrame)(async()=>{if(!(1>=this.$video.readyState)){var e=Date.now()-this._lastScanTimestamp,t=1e3/this._maxScansPerSecond;e<t&&await new Promise(r=>setTimeout(r,t-e)),this._lastScanTimestamp=Date.now();try{var o=await L.scanImage(this.$video,{scanRegion:this._scanRegion,qrEngine:this._qrEnginePromise,canvas:this.$canvas})}catch(r){if(!this._active)return;this._onDecodeError(r)}!L._disableBarcodeDetector||await this._qrEnginePromise instanceof Worker||(this._qrEnginePromise=L.createQrEngine()),o?(this._onDecode?this._onDecode(o):this._legacyOnDecode&&this._legacyOnDecode(o.data),this.$codeOutlineHighlight&&(clearTimeout(this._codeOutlineHighlightRemovalTimeout),this._codeOutlineHighlightRemovalTimeout=void 0,this.$codeOutlineHighlight.setAttribute("viewBox",`${this._scanRegion.x||0} ${this._scanRegion.y||0} ${this._scanRegion.width||this.$video.videoWidth} ${this._scanRegion.height||this.$video.videoHeight}`),this.$codeOutlineHighlight.firstElementChild.setAttribute("points",o.cornerPoints.map(({x:r,y:i})=>`${r},${i}`).join(" ")),this.$codeOutlineHighlight.style.display="")):this.$codeOutlineHighlight&&!this._codeOutlineHighlightRemovalTimeout&&(this._codeOutlineHighlightRemovalTimeout=setTimeout(()=>this.$codeOutlineHighlight.style.display="none",100))}this._scanFrame()})}_onDecodeError(e){e!==L.NO_QR_CODE_FOUND&&console.log(e)}async _getCameraStream(){if(!navigator.mediaDevices)throw"Camera not found.";let e=/^(environment|user)$/.test(this._preferredCamera)?"facingMode":"deviceId",t=[{width:{min:1024}},{width:{min:768}},{}],o=t.map(r=>Object.assign({},r,{[e]:{exact:this._preferredCamera}}));for(let r of[...o,...t])try{let i=await navigator.mediaDevices.getUserMedia({video:r,audio:!1}),s=this._getFacingMode(i)||(r.facingMode?this._preferredCamera:this._preferredCamera==="environment"?"user":"environment");return{stream:i,facingMode:s}}catch{}throw"Camera not found."}async _restartVideoStream(){let e=this._paused;await this.pause(!0)&&!e&&this._active&&await this.start()}static _stopVideoStream(e){for(let t of e.getTracks())t.stop(),e.removeTrack(t)}_setVideoMirror(e){this.$video.style.transform="scaleX("+(e==="user"?-1:1)+")"}_getFacingMode(e){return(e=e.getVideoTracks()[0])?/rear|back|environment/i.test(e.label)?"environment":/front|user|face/i.test(e.label)?"user":null:null}static _drawToCanvas(e,t,o,r=!1){o=o||document.createElement("canvas");let i=t&&t.x?t.x:0,s=t&&t.y?t.y:0,a=t&&t.width?t.width:e.videoWidth||e.width,c=t&&t.height?t.height:e.videoHeight||e.height;return r||(r=t&&t.downScaledWidth?t.downScaledWidth:a,t=t&&t.downScaledHeight?t.downScaledHeight:c,o.width!==r&&(o.width=r),o.height!==t&&(o.height=t)),t=o.getContext("2d",{alpha:!1}),t.imageSmoothingEnabled=!1,t.drawImage(e,i,s,a,c,0,0,o.width,o.height),[o,t]}static async _loadImage(e){if(e instanceof Image)return await L._awaitImageLoad(e),e;if(e instanceof HTMLVideoElement||e instanceof HTMLCanvasElement||e instanceof SVGImageElement||"OffscreenCanvas"in window&&e instanceof OffscreenCanvas||"ImageBitmap"in window&&e instanceof ImageBitmap)return e;if(e instanceof File||e instanceof Blob||e instanceof URL||typeof e=="string"){let t=new Image;t.src=e instanceof File||e instanceof Blob?URL.createObjectURL(e):e.toString();try{return await L._awaitImageLoad(t),t}finally{(e instanceof File||e instanceof Blob)&&URL.revokeObjectURL(t.src)}}else throw"Unsupported image type."}static async _awaitImageLoad(e){e.complete&&e.naturalWidth!==0||await new Promise((t,o)=>{let r=i=>{e.removeEventListener("load",r),e.removeEventListener("error",r),i instanceof ErrorEvent?o("Image load error"):t()};e.addEventListener("load",r),e.addEventListener("error",r)})}static async _postWorkerMessage(e,t,o,r){return L._postWorkerMessageSync(await e,t,o,r)}static _postWorkerMessageSync(e,t,o,r){if(!(e instanceof Worker))return-1;let i=L._workerMessageId++;return e.postMessage({id:i,type:t,data:o},r),i}}L.DEFAULT_CANVAS_SIZE=400;L.NO_QR_CODE_FOUND="No QR code found";L._disableBarcodeDetector=!1;L._workerMessageId=0;class dt{constructor(){this.scanner=null,this.video=null,this.isScanning=!1,this.onDetectedCallback=null,this.onErrorCallback=null,this.animationFrame=null,this.permissionGranted=!1}async init(e,t,o){this.video=e,this.onDetectedCallback=t,this.onErrorCallback=o;try{return this.showPermissionRequest(),await this.requestCameraPermission(),this.hidePermissionRequest(),this.showScannerInterface(),this.scanner=new L(this.video,r=>this.handleQRDetected(r),{returnDetailedScanResult:!0,highlightScanRegion:!1,highlightCodeOutline:!1,preferredCamera:"environment",maxScansPerSecond:5,calculateScanRegion:()=>{const r=document.querySelector(".qr-frame");if(r){const i=r.getBoundingClientRect(),s=this.video.getBoundingClientRect();return{x:Math.max(0,(i.left-s.left)/s.width),y:Math.max(0,(i.top-s.top)/s.height),width:Math.min(1,i.width/s.width),height:Math.min(1,i.height/s.height)}}return{x:.1,y:.1,width:.8,height:.8}}}),this.startScanAnimation(),!0}catch(r){return console.error("Error initializing QR scanner:",r),this.hidePermissionRequest(),this.onErrorCallback&&this.onErrorCallback("Erro ao inicializar scanner: "+r.message),!1}}showPermissionRequest(){const e=document.querySelector(".qr-overlay");e&&(e.innerHTML=`
        <div class="permission-request">
          <div class="permission-icon">
            <iconify-icon icon="mdi:camera"></iconify-icon>
          </div>
          <h3>Permissão da Câmera</h3>
          <p>Este aplicativo precisa acessar sua câmera para escanear códigos QR</p>
          <div class="permission-loading">
            <div class="loading-spinner"></div>
            <span>Aguardando permissão...</span>
          </div>
        </div>
      `,e.style.display="flex")}hidePermissionRequest(){const e=document.querySelector(".qr-overlay");e&&(e.style.display="none")}showScannerInterface(){const e=document.querySelector(".qr-overlay");e&&(e.innerHTML=`
        <div class="qr-scanner-interface">
          <div class="qr-frame">
            <div class="qr-corner top-left"></div>
            <div class="qr-corner top-right"></div>
            <div class="qr-corner bottom-left"></div>
            <div class="qr-corner bottom-right"></div>
            <div class="qr-scan-line"></div>
          </div>
          <div class="qr-instruction">
            <iconify-icon icon="mdi:qrcode-scan"></iconify-icon>
            <p>Posicione o QR Code dentro do quadro</p>
          </div>
          <div class="qr-controls">
            <button class="qr-control-btn" id="qrFlashBtn">
              <iconify-icon icon="mdi:flash-off"></iconify-icon>
            </button>
            <button class="qr-control-btn" id="qrSwitchBtn">
              <iconify-icon icon="mdi:camera-flip"></iconify-icon>
            </button>
          </div>
        </div>
      `,e.style.display="flex",this.setupControlButtons())}setupControlButtons(){const e=document.getElementById("qrFlashBtn"),t=document.getElementById("qrSwitchBtn");e&&e.addEventListener("click",()=>this.toggleFlash()),t&&t.addEventListener("click",()=>this.switchCamera())}async requestCameraPermission(){try{return navigator.permissions&&(await navigator.permissions.query({name:"camera"})).state==="granted"?(this.permissionGranted=!0,!0):((await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1920},height:{ideal:1080}}})).getTracks().forEach(t=>t.stop()),this.permissionGranted=!0,!0)}catch(e){this.permissionGranted=!1;let t="Permissão de câmera negada";throw e.name==="NotAllowedError"?t="Permissão de câmera negada. Por favor, permita o acesso à câmera nas configurações do navegador.":e.name==="NotFoundError"?t="Nenhuma câmera encontrada no dispositivo.":e.name==="NotSupportedError"?t="Câmera não suportada neste navegador.":e.name==="NotReadableError"&&(t="Câmera está sendo usada por outro aplicativo."),new Error(t)}}async start(){if(!this.scanner)throw new Error("Scanner não inicializado");if(!this.permissionGranted)throw new Error("Permissão de câmera não concedida");try{await this.scanner.start(),this.isScanning=!0,this.startScanAnimation(),this.startPulseAnimation()}catch(e){throw console.error("Error starting scanner:",e),new Error("Erro ao iniciar scanner: "+e.message)}}stop(){this.scanner&&(this.scanner.stop(),this.isScanning=!1),this.animationFrame&&(cancelAnimationFrame(this.animationFrame),this.animationFrame=null),this.stopPulseAnimation()}destroy(){this.stop(),this.scanner&&(this.scanner.destroy(),this.scanner=null)}handleQRDetected(e){this.onDetectedCallback&&(this.showSuccessAnimation(),navigator.vibrate&&navigator.vibrate([100,50,100]),setTimeout(()=>{this.onDetectedCallback(e.data)},500))}startScanAnimation(){const e=document.querySelector(".qr-scan-line");if(!e)return;let t=0;const o=()=>{this.isScanning&&(t+=1.5,t>100&&(t=0),e.style.top=`${t}%`,this.animationFrame=requestAnimationFrame(o))};o()}startPulseAnimation(){const e=document.querySelector(".qr-frame");e&&e.classList.add("qr-scanning")}stopPulseAnimation(){const e=document.querySelector(".qr-frame");e&&e.classList.remove("qr-scanning")}showSuccessAnimation(){const e=document.querySelector(".qr-frame"),t=document.querySelector(".qr-instruction");e&&(e.classList.add("qr-success"),e.classList.remove("qr-scanning")),t&&(t.innerHTML=`
        <iconify-icon icon="mdi:check-circle" style="color: #34C759;"></iconify-icon>
        <p style="color: #34C759;">QR Code detectado com sucesso!</p>
      `),setTimeout(()=>{e&&e.classList.remove("qr-success")},1e3)}async switchCamera(){if(this.scanner)try{const t=await this.scanner.getCamera()==="environment"?"user":"environment";await this.scanner.setCamera(t);const o=document.getElementById("qrSwitchBtn");o&&(o.style.transform="rotateY(180deg)",setTimeout(()=>{o.style.transform="rotateY(0deg)"},300))}catch(e){console.error("Error switching camera:",e)}}async toggleFlash(){if(this.scanner)try{const e=document.getElementById("qrFlashBtn"),t=e==null?void 0:e.querySelector("iconify-icon");if(await this.scanner.toggleFlash(),t){const o=t.getAttribute("icon")==="mdi:flash-off";t.setAttribute("icon",o?"mdi:flash":"mdi:flash-off"),e.style.transform="scale(1.2)",setTimeout(()=>{e.style.transform="scale(1)"},200)}}catch(e){console.error("Error toggling flash:",e)}}}class ut{constructor(){this.stream=null,this.video=null,this.canvas=null,this.context=null,this.currentCamera="user",this.flashEnabled=!1,this.isQRMode=!1,this.qrScanner=null,this.onCaptureCallback=null,this.onQRDetectedCallback=null,this.init()}init(){var e;this.video=document.getElementById("cameraVideo"),this.canvas=document.getElementById("cameraCanvas"),this.context=(e=this.canvas)==null?void 0:e.getContext("2d"),this.setupEventListeners()}setupEventListeners(){var e,t,o,r,i,s,a;(e=document.getElementById("closeCameraBtn"))==null||e.addEventListener("click",()=>{this.closeCamera()}),(t=document.getElementById("switchCameraBtn"))==null||t.addEventListener("click",()=>{this.switchCamera()}),(o=document.getElementById("flashBtn"))==null||o.addEventListener("click",()=>{this.toggleFlash()}),(r=document.getElementById("captureBtn"))==null||r.addEventListener("click",()=>{this.capturePhoto()}),(i=document.getElementById("galleryBtn"))==null||i.addEventListener("click",()=>{this.openGallery()}),(s=document.getElementById("openCamera"))==null||s.addEventListener("click",()=>{this.openCamera("photo")}),(a=document.getElementById("scanQR"))==null||a.addEventListener("click",()=>{this.openCamera("qr")})}async openCamera(e="photo"){try{this.isQRMode=e==="qr";const t=document.getElementById("cameraTitle"),o=document.getElementById("qrOverlay");this.isQRMode?(t.textContent="Escanear QR Code",o.style.display="flex",await this.startCustomQRScanner()):(t.textContent="Câmera",o.style.display="none",this.stopQRScanner(),await this.startCamera()),document.getElementById("cameraModal").classList.add("show"),this.addCameraAnimations()}catch(t){console.error("Error opening camera:",t),this.showToast("Erro ao acessar a câmera: "+t.message,"error")}}async startCustomQRScanner(){try{this.qrScanner=new dt,await this.qrScanner.init(this.video,t=>{this.onQRDetectedCallback&&this.onQRDetectedCallback(t),setTimeout(()=>{this.closeCamera()},1e3)},t=>{this.showToast(t,"error")})&&await this.qrScanner.start()}catch(e){console.error("Error starting QR scanner:",e),this.showToast("Erro ao iniciar scanner QR: "+e.message,"error")}}async startCamera(){try{this.stream&&this.stream.getTracks().forEach(t=>t.stop());const e={video:{facingMode:this.currentCamera,width:{ideal:1920},height:{ideal:1080}},audio:!1};this.stream=await navigator.mediaDevices.getUserMedia(e),this.video.srcObject=this.stream,this.video.addEventListener("loadedmetadata",()=>{this.canvas.width=this.video.videoWidth,this.canvas.height=this.video.videoHeight})}catch(e){throw new Error("Não foi possível acessar a câmera: "+e.message)}}async switchCamera(){try{this.isQRMode&&this.qrScanner?await this.qrScanner.switchCamera():(this.currentCamera=this.currentCamera==="user"?"environment":"user",await this.startCamera());const e=document.getElementById("switchCameraBtn");e.style.transform="rotateY(180deg)",setTimeout(()=>{e.style.transform="rotateY(0deg)"},300)}catch(e){console.error("Error switching camera:",e),this.showToast("Erro ao trocar câmera","error")}}async toggleFlash(){try{if(this.isQRMode&&this.qrScanner)await this.qrScanner.toggleFlash();else{const e=this.stream.getVideoTracks()[0];if(e.getCapabilities().torch){this.flashEnabled=!this.flashEnabled,await e.applyConstraints({advanced:[{torch:this.flashEnabled}]});const o=document.getElementById("flashBtn");o.querySelector("iconify-icon").setAttribute("icon",this.flashEnabled?"mdi:flash":"mdi:flash-off"),o.style.transform="scale(1.2)",setTimeout(()=>{o.style.transform="scale(1)"},200)}else this.showToast("Flash não disponível neste dispositivo","warning")}}catch(e){console.error("Error toggling flash:",e),this.showToast("Erro ao controlar flash","error")}}capturePhoto(){if(!(!this.video||!this.canvas||!this.context))try{this.canvas.width=this.video.videoWidth,this.canvas.height=this.video.videoHeight,this.context.drawImage(this.video,0,0),this.canvas.toBlob(e=>{e&&this.onCaptureCallback&&this.onCaptureCallback(e),this.closeCamera()},"image/jpeg",.9),this.addCaptureAnimation()}catch(e){console.error("Error capturing photo:",e),this.showToast("Erro ao capturar foto","error")}}openGallery(){const e=document.createElement("input");e.type="file",e.accept="image/*",e.style.display="none",e.addEventListener("change",t=>{const o=t.target.files[0];o&&this.onCaptureCallback&&(this.onCaptureCallback(o),this.closeCamera())}),document.body.appendChild(e),e.click(),document.body.removeChild(e)}stopQRScanner(){this.qrScanner&&(this.qrScanner.destroy(),this.qrScanner=null)}closeCamera(){this.stream&&(this.stream.getTracks().forEach(r=>r.stop()),this.stream=null),this.stopQRScanner(),document.getElementById("cameraModal").classList.remove("show"),this.flashEnabled=!1;const t=document.getElementById("flashBtn"),o=t==null?void 0:t.querySelector("iconify-icon");o&&o.setAttribute("icon","mdi:flash-off")}addCameraAnimations(){document.querySelectorAll(".camera-control-btn").forEach((o,r)=>{o.style.opacity="0",o.style.transform="scale(0.8)",setTimeout(()=>{o.style.transition="all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94)",o.style.opacity="1",o.style.transform="scale(1)"},r*100)});const t=document.getElementById("captureBtn");t&&(t.style.opacity="0",t.style.transform="scale(0.5)",setTimeout(()=>{t.style.transition="all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94)",t.style.opacity="1",t.style.transform="scale(1)"},300))}addCaptureAnimation(){const e=document.querySelector(".camera-viewport"),t=document.createElement("div");t.style.cssText=`
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: white;
      opacity: 0;
      pointer-events: none;
      z-index: 1000;
    `,e.appendChild(t),t.style.transition="opacity 0.1s ease",t.style.opacity="0.8",setTimeout(()=>{t.style.opacity="0",setTimeout(()=>{e.removeChild(t)},100)},100);const o=document.getElementById("captureBtn"),r=o.querySelector(".capture-ring"),i=o.querySelector(".capture-inner");r.style.transform="scale(1.2)",i.style.transform="scale(0.8)",setTimeout(()=>{r.style.transform="scale(1)",i.style.transform="scale(1)"},200)}showToast(e,t="info"){const o=document.createElement("div");o.className=`toast ${t}`;const r={success:"mdi:check-circle",error:"mdi:alert-circle",warning:"mdi:alert",info:"mdi:information"};o.innerHTML=`
      <iconify-icon icon="${r[t]||r.info}"></iconify-icon>
      <div class="toast-content">
        <div class="toast-title">${e}</div>
      </div>
      <button class="toast-close">
        <iconify-icon icon="mdi:close"></iconify-icon>
      </button>
    `;const i=document.getElementById("toastContainer");i.appendChild(o),setTimeout(()=>{o.style.opacity="0",o.style.transform="translateX(100%)",setTimeout(()=>{i.contains(o)&&i.removeChild(o)},300)},3e3),o.querySelector(".toast-close").addEventListener("click",()=>{o.style.opacity="0",o.style.transform="translateX(100%)",setTimeout(()=>{i.contains(o)&&i.removeChild(o)},300)})}onCapture(e){this.onCaptureCallback=e}onQRDetected(e){this.onQRDetectedCallback=e}}function ht(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var O={},K,Se;function mt(){return Se||(Se=1,K=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),K}var J={},F={},Be;function k(){if(Be)return F;Be=1;let n;const e=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return F.getSymbolSize=function(o){if(!o)throw new Error('"version" cannot be null or undefined');if(o<1||o>40)throw new Error('"version" should be in range from 1 to 40');return o*4+17},F.getSymbolTotalCodewords=function(o){return e[o]},F.getBCHDigit=function(t){let o=0;for(;t!==0;)o++,t>>>=1;return o},F.setToSJISFunction=function(o){if(typeof o!="function")throw new Error('"toSJISFunc" is not a valid function.');n=o},F.isKanjiModeEnabled=function(){return typeof n<"u"},F.toSJIS=function(o){return n(o)},F}var Y={},Ie;function ve(){return Ie||(Ie=1,function(n){n.L={bit:1},n.M={bit:0},n.Q={bit:3},n.H={bit:2};function e(t){if(typeof t!="string")throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return n.L;case"m":case"medium":return n.M;case"q":case"quartile":return n.Q;case"h":case"high":return n.H;default:throw new Error("Unknown EC Level: "+t)}}n.isValid=function(o){return o&&typeof o.bit<"u"&&o.bit>=0&&o.bit<4},n.from=function(o,r){if(n.isValid(o))return o;try{return e(o)}catch{return r}}}(Y)),Y}var X,Re;function gt(){if(Re)return X;Re=1;function n(){this.buffer=[],this.length=0}return n.prototype={get:function(e){const t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)===1},put:function(e,t){for(let o=0;o<t;o++)this.putBit((e>>>t-o-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},X=n,X}var Z,Pe;function ft(){if(Pe)return Z;Pe=1;function n(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}return n.prototype.set=function(e,t,o,r){const i=e*this.size+t;this.data[i]=o,r&&(this.reservedBit[i]=!0)},n.prototype.get=function(e,t){return this.data[e*this.size+t]},n.prototype.xor=function(e,t,o){this.data[e*this.size+t]^=o},n.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]},Z=n,Z}var ee={},Me;function pt(){return Me||(Me=1,function(n){const e=k().getSymbolSize;n.getRowColCoords=function(o){if(o===1)return[];const r=Math.floor(o/7)+2,i=e(o),s=i===145?26:Math.ceil((i-13)/(2*r-2))*2,a=[i-7];for(let c=1;c<r-1;c++)a[c]=a[c-1]-s;return a.push(6),a.reverse()},n.getPositions=function(o){const r=[],i=n.getRowColCoords(o),s=i.length;for(let a=0;a<s;a++)for(let c=0;c<s;c++)a===0&&c===0||a===0&&c===s-1||a===s-1&&c===0||r.push([i[a],i[c]]);return r}}(ee)),ee}var te={},Le;function yt(){if(Le)return te;Le=1;const n=k().getSymbolSize,e=7;return te.getPositions=function(o){const r=n(o);return[[0,0],[r-e,0],[0,r-e]]},te}var oe={},Te;function vt(){return Te||(Te=1,function(n){n.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};n.isValid=function(r){return r!=null&&r!==""&&!isNaN(r)&&r>=0&&r<=7},n.from=function(r){return n.isValid(r)?parseInt(r,10):void 0},n.getPenaltyN1=function(r){const i=r.size;let s=0,a=0,c=0,l=null,u=null;for(let m=0;m<i;m++){a=c=0,l=u=null;for(let d=0;d<i;d++){let h=r.get(m,d);h===l?a++:(a>=5&&(s+=e.N1+(a-5)),l=h,a=1),h=r.get(d,m),h===u?c++:(c>=5&&(s+=e.N1+(c-5)),u=h,c=1)}a>=5&&(s+=e.N1+(a-5)),c>=5&&(s+=e.N1+(c-5))}return s},n.getPenaltyN2=function(r){const i=r.size;let s=0;for(let a=0;a<i-1;a++)for(let c=0;c<i-1;c++){const l=r.get(a,c)+r.get(a,c+1)+r.get(a+1,c)+r.get(a+1,c+1);(l===4||l===0)&&s++}return s*e.N2},n.getPenaltyN3=function(r){const i=r.size;let s=0,a=0,c=0;for(let l=0;l<i;l++){a=c=0;for(let u=0;u<i;u++)a=a<<1&2047|r.get(l,u),u>=10&&(a===1488||a===93)&&s++,c=c<<1&2047|r.get(u,l),u>=10&&(c===1488||c===93)&&s++}return s*e.N3},n.getPenaltyN4=function(r){let i=0;const s=r.data.length;for(let c=0;c<s;c++)i+=r.data[c];return Math.abs(Math.ceil(i*100/s/5)-10)*e.N4};function t(o,r,i){switch(o){case n.Patterns.PATTERN000:return(r+i)%2===0;case n.Patterns.PATTERN001:return r%2===0;case n.Patterns.PATTERN010:return i%3===0;case n.Patterns.PATTERN011:return(r+i)%3===0;case n.Patterns.PATTERN100:return(Math.floor(r/2)+Math.floor(i/3))%2===0;case n.Patterns.PATTERN101:return r*i%2+r*i%3===0;case n.Patterns.PATTERN110:return(r*i%2+r*i%3)%2===0;case n.Patterns.PATTERN111:return(r*i%3+(r+i)%2)%2===0;default:throw new Error("bad maskPattern:"+o)}}n.applyMask=function(r,i){const s=i.size;for(let a=0;a<s;a++)for(let c=0;c<s;c++)i.isReserved(c,a)||i.xor(c,a,t(r,c,a))},n.getBestMask=function(r,i){const s=Object.keys(n.Patterns).length;let a=0,c=1/0;for(let l=0;l<s;l++){i(l),n.applyMask(l,r);const u=n.getPenaltyN1(r)+n.getPenaltyN2(r)+n.getPenaltyN3(r)+n.getPenaltyN4(r);n.applyMask(l,r),u<c&&(c=u,a=l)}return a}}(oe)),oe}var V={},_e;function Ze(){if(_e)return V;_e=1;const n=ve(),e=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],t=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return V.getBlocksCount=function(r,i){switch(i){case n.L:return e[(r-1)*4+0];case n.M:return e[(r-1)*4+1];case n.Q:return e[(r-1)*4+2];case n.H:return e[(r-1)*4+3];default:return}},V.getTotalCodewordsCount=function(r,i){switch(i){case n.L:return t[(r-1)*4+0];case n.M:return t[(r-1)*4+1];case n.Q:return t[(r-1)*4+2];case n.H:return t[(r-1)*4+3];default:return}},V}var re={},j={},Ae;function wt(){if(Ae)return j;Ae=1;const n=new Uint8Array(512),e=new Uint8Array(256);return function(){let o=1;for(let r=0;r<255;r++)n[r]=o,e[o]=r,o<<=1,o&256&&(o^=285);for(let r=255;r<512;r++)n[r]=n[r-255]}(),j.log=function(o){if(o<1)throw new Error("log("+o+")");return e[o]},j.exp=function(o){return n[o]},j.mul=function(o,r){return o===0||r===0?0:n[e[o]+e[r]]},j}var De;function Et(){return De||(De=1,function(n){const e=wt();n.mul=function(o,r){const i=new Uint8Array(o.length+r.length-1);for(let s=0;s<o.length;s++)for(let a=0;a<r.length;a++)i[s+a]^=e.mul(o[s],r[a]);return i},n.mod=function(o,r){let i=new Uint8Array(o);for(;i.length-r.length>=0;){const s=i[0];for(let c=0;c<r.length;c++)i[c]^=e.mul(r[c],s);let a=0;for(;a<i.length&&i[a]===0;)a++;i=i.slice(a)}return i},n.generateECPolynomial=function(o){let r=new Uint8Array([1]);for(let i=0;i<o;i++)r=n.mul(r,new Uint8Array([1,e.exp(i)]));return r}}(re)),re}var ie,qe;function Ct(){if(qe)return ie;qe=1;const n=Et();function e(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}return e.prototype.initialize=function(o){this.degree=o,this.genPoly=n.generateECPolynomial(this.degree)},e.prototype.encode=function(o){if(!this.genPoly)throw new Error("Encoder not initialized");const r=new Uint8Array(o.length+this.degree);r.set(o);const i=n.mod(r,this.genPoly),s=this.degree-i.length;if(s>0){const a=new Uint8Array(this.degree);return a.set(i,s),a}return i},ie=e,ie}var se={},ne={},ae={},xe;function et(){return xe||(xe=1,ae.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40}),ae}var A={},Fe;function tt(){if(Fe)return A;Fe=1;const n="[0-9]+",e="[A-Z $%*+\\-./:]+";let t="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";t=t.replace(/u/g,"\\u");const o="(?:(?![A-Z0-9 $%*+\\-./:]|"+t+`)(?:.|[\r
]))+`;A.KANJI=new RegExp(t,"g"),A.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),A.BYTE=new RegExp(o,"g"),A.NUMERIC=new RegExp(n,"g"),A.ALPHANUMERIC=new RegExp(e,"g");const r=new RegExp("^"+t+"$"),i=new RegExp("^"+n+"$"),s=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return A.testKanji=function(c){return r.test(c)},A.testNumeric=function(c){return i.test(c)},A.testAlphanumeric=function(c){return s.test(c)},A}var ke;function N(){return ke||(ke=1,function(n){const e=et(),t=tt();n.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},n.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},n.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},n.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},n.MIXED={bit:-1},n.getCharCountIndicator=function(i,s){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!e.isValid(s))throw new Error("Invalid version: "+s);return s>=1&&s<10?i.ccBits[0]:s<27?i.ccBits[1]:i.ccBits[2]},n.getBestModeForData=function(i){return t.testNumeric(i)?n.NUMERIC:t.testAlphanumeric(i)?n.ALPHANUMERIC:t.testKanji(i)?n.KANJI:n.BYTE},n.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},n.isValid=function(i){return i&&i.bit&&i.ccBits};function o(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"numeric":return n.NUMERIC;case"alphanumeric":return n.ALPHANUMERIC;case"kanji":return n.KANJI;case"byte":return n.BYTE;default:throw new Error("Unknown mode: "+r)}}n.from=function(i,s){if(n.isValid(i))return i;try{return o(i)}catch{return s}}}(ne)),ne}var Ne;function bt(){return Ne||(Ne=1,function(n){const e=k(),t=Ze(),o=ve(),r=N(),i=et(),s=7973,a=e.getBCHDigit(s);function c(d,h,b){for(let R=1;R<=40;R++)if(h<=n.getCapacity(R,b,d))return R}function l(d,h){return r.getCharCountIndicator(d,h)+4}function u(d,h){let b=0;return d.forEach(function(R){const T=l(R.mode,h);b+=T+R.getBitsLength()}),b}function m(d,h){for(let b=1;b<=40;b++)if(u(d,b)<=n.getCapacity(b,h,r.MIXED))return b}n.from=function(h,b){return i.isValid(h)?parseInt(h,10):b},n.getCapacity=function(h,b,R){if(!i.isValid(h))throw new Error("Invalid QR Code version");typeof R>"u"&&(R=r.BYTE);const T=e.getSymbolTotalCodewords(h),y=t.getTotalCodewordsCount(h,b),P=(T-y)*8;if(R===r.MIXED)return P;const E=P-l(R,h);switch(R){case r.NUMERIC:return Math.floor(E/10*3);case r.ALPHANUMERIC:return Math.floor(E/11*2);case r.KANJI:return Math.floor(E/13);case r.BYTE:default:return Math.floor(E/8)}},n.getBestVersionForData=function(h,b){let R;const T=o.from(b,o.M);if(Array.isArray(h)){if(h.length>1)return m(h,T);if(h.length===0)return 1;R=h[0]}else R=h;return c(R.mode,R.getLength(),T)},n.getEncodedBits=function(h){if(!i.isValid(h)||h<7)throw new Error("Invalid QR Code version");let b=h<<12;for(;e.getBCHDigit(b)-a>=0;)b^=s<<e.getBCHDigit(b)-a;return h<<12|b}}(se)),se}var ce={},Ue;function St(){if(Ue)return ce;Ue=1;const n=k(),e=1335,t=21522,o=n.getBCHDigit(e);return ce.getEncodedBits=function(i,s){const a=i.bit<<3|s;let c=a<<10;for(;n.getBCHDigit(c)-o>=0;)c^=e<<n.getBCHDigit(c)-o;return(a<<10|c)^t},ce}var le={},de,Oe;function Bt(){if(Oe)return de;Oe=1;const n=N();function e(t){this.mode=n.NUMERIC,this.data=t.toString()}return e.getBitsLength=function(o){return 10*Math.floor(o/3)+(o%3?o%3*3+1:0)},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(o){let r,i,s;for(r=0;r+3<=this.data.length;r+=3)i=this.data.substr(r,3),s=parseInt(i,10),o.put(s,10);const a=this.data.length-r;a>0&&(i=this.data.substr(r),s=parseInt(i,10),o.put(s,a*3+1))},de=e,de}var ue,$e;function It(){if($e)return ue;$e=1;const n=N(),e=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function t(o){this.mode=n.ALPHANUMERIC,this.data=o}return t.getBitsLength=function(r){return 11*Math.floor(r/2)+6*(r%2)},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(r){let i;for(i=0;i+2<=this.data.length;i+=2){let s=e.indexOf(this.data[i])*45;s+=e.indexOf(this.data[i+1]),r.put(s,11)}this.data.length%2&&r.put(e.indexOf(this.data[i]),6)},ue=t,ue}var he,je;function Rt(){if(je)return he;je=1;const n=N();function e(t){this.mode=n.BYTE,typeof t=="string"?this.data=new TextEncoder().encode(t):this.data=new Uint8Array(t)}return e.getBitsLength=function(o){return o*8},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(t){for(let o=0,r=this.data.length;o<r;o++)t.put(this.data[o],8)},he=e,he}var me,ze;function Pt(){if(ze)return me;ze=1;const n=N(),e=k();function t(o){this.mode=n.KANJI,this.data=o}return t.getBitsLength=function(r){return r*13},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(o){let r;for(r=0;r<this.data.length;r++){let i=e.toSJIS(this.data[r]);if(i>=33088&&i<=40956)i-=33088;else if(i>=57408&&i<=60351)i-=49472;else throw new Error("Invalid SJIS character: "+this.data[r]+`
Make sure your charset is UTF-8`);i=(i>>>8&255)*192+(i&255),o.put(i,13)}},me=t,me}var ge={exports:{}},Ve;function Mt(){return Ve||(Ve=1,function(n){var e={single_source_shortest_paths:function(t,o,r){var i={},s={};s[o]=0;var a=e.PriorityQueue.make();a.push(o,0);for(var c,l,u,m,d,h,b,R,T;!a.empty();){c=a.pop(),l=c.value,m=c.cost,d=t[l]||{};for(u in d)d.hasOwnProperty(u)&&(h=d[u],b=m+h,R=s[u],T=typeof s[u]>"u",(T||R>b)&&(s[u]=b,a.push(u,b),i[u]=l))}if(typeof r<"u"&&typeof s[r]>"u"){var y=["Could not find a path from ",o," to ",r,"."].join("");throw new Error(y)}return i},extract_shortest_path_from_predecessor_list:function(t,o){for(var r=[],i=o;i;)r.push(i),t[i],i=t[i];return r.reverse(),r},find_path:function(t,o,r){var i=e.single_source_shortest_paths(t,o,r);return e.extract_shortest_path_from_predecessor_list(i,r)},PriorityQueue:{make:function(t){var o=e.PriorityQueue,r={},i;t=t||{};for(i in o)o.hasOwnProperty(i)&&(r[i]=o[i]);return r.queue=[],r.sorter=t.sorter||o.default_sorter,r},default_sorter:function(t,o){return t.cost-o.cost},push:function(t,o){var r={value:t,cost:o};this.queue.push(r),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};n.exports=e}(ge)),ge.exports}var He;function Lt(){return He||(He=1,function(n){const e=N(),t=Bt(),o=It(),r=Rt(),i=Pt(),s=tt(),a=k(),c=Mt();function l(y){return unescape(encodeURIComponent(y)).length}function u(y,P,E){const p=[];let _;for(;(_=y.exec(E))!==null;)p.push({data:_[0],index:_.index,mode:P,length:_[0].length});return p}function m(y){const P=u(s.NUMERIC,e.NUMERIC,y),E=u(s.ALPHANUMERIC,e.ALPHANUMERIC,y);let p,_;return a.isKanjiModeEnabled()?(p=u(s.BYTE,e.BYTE,y),_=u(s.KANJI,e.KANJI,y)):(p=u(s.BYTE_KANJI,e.BYTE,y),_=[]),P.concat(E,p,_).sort(function(S,C){return S.index-C.index}).map(function(S){return{data:S.data,mode:S.mode,length:S.length}})}function d(y,P){switch(P){case e.NUMERIC:return t.getBitsLength(y);case e.ALPHANUMERIC:return o.getBitsLength(y);case e.KANJI:return i.getBitsLength(y);case e.BYTE:return r.getBitsLength(y)}}function h(y){return y.reduce(function(P,E){const p=P.length-1>=0?P[P.length-1]:null;return p&&p.mode===E.mode?(P[P.length-1].data+=E.data,P):(P.push(E),P)},[])}function b(y){const P=[];for(let E=0;E<y.length;E++){const p=y[E];switch(p.mode){case e.NUMERIC:P.push([p,{data:p.data,mode:e.ALPHANUMERIC,length:p.length},{data:p.data,mode:e.BYTE,length:p.length}]);break;case e.ALPHANUMERIC:P.push([p,{data:p.data,mode:e.BYTE,length:p.length}]);break;case e.KANJI:P.push([p,{data:p.data,mode:e.BYTE,length:l(p.data)}]);break;case e.BYTE:P.push([{data:p.data,mode:e.BYTE,length:l(p.data)}])}}return P}function R(y,P){const E={},p={start:{}};let _=["start"];for(let f=0;f<y.length;f++){const S=y[f],C=[];for(let g=0;g<S.length;g++){const I=S[g],v=""+f+g;C.push(v),E[v]={node:I,lastCount:0},p[v]={};for(let B=0;B<_.length;B++){const w=_[B];E[w]&&E[w].node.mode===I.mode?(p[w][v]=d(E[w].lastCount+I.length,I.mode)-d(E[w].lastCount,I.mode),E[w].lastCount+=I.length):(E[w]&&(E[w].lastCount=I.length),p[w][v]=d(I.length,I.mode)+4+e.getCharCountIndicator(I.mode,P))}}_=C}for(let f=0;f<_.length;f++)p[_[f]].end=0;return{map:p,table:E}}function T(y,P){let E;const p=e.getBestModeForData(y);if(E=e.from(P,p),E!==e.BYTE&&E.bit<p.bit)throw new Error('"'+y+'" cannot be encoded with mode '+e.toString(E)+`.
 Suggested mode is: `+e.toString(p));switch(E===e.KANJI&&!a.isKanjiModeEnabled()&&(E=e.BYTE),E){case e.NUMERIC:return new t(y);case e.ALPHANUMERIC:return new o(y);case e.KANJI:return new i(y);case e.BYTE:return new r(y)}}n.fromArray=function(P){return P.reduce(function(E,p){return typeof p=="string"?E.push(T(p,null)):p.data&&E.push(T(p.data,p.mode)),E},[])},n.fromString=function(P,E){const p=m(P,a.isKanjiModeEnabled()),_=b(p),f=R(_,E),S=c.find_path(f.map,"start","end"),C=[];for(let g=1;g<S.length-1;g++)C.push(f.table[S[g]].node);return n.fromArray(h(C))},n.rawSplit=function(P){return n.fromArray(m(P,a.isKanjiModeEnabled()))}}(le)),le}var Qe;function Tt(){if(Qe)return J;Qe=1;const n=k(),e=ve(),t=gt(),o=ft(),r=pt(),i=yt(),s=vt(),a=Ze(),c=Ct(),l=bt(),u=St(),m=N(),d=Lt();function h(f,S){const C=f.size,g=i.getPositions(S);for(let I=0;I<g.length;I++){const v=g[I][0],B=g[I][1];for(let w=-1;w<=7;w++)if(!(v+w<=-1||C<=v+w))for(let M=-1;M<=7;M++)B+M<=-1||C<=B+M||(w>=0&&w<=6&&(M===0||M===6)||M>=0&&M<=6&&(w===0||w===6)||w>=2&&w<=4&&M>=2&&M<=4?f.set(v+w,B+M,!0,!0):f.set(v+w,B+M,!1,!0))}}function b(f){const S=f.size;for(let C=8;C<S-8;C++){const g=C%2===0;f.set(C,6,g,!0),f.set(6,C,g,!0)}}function R(f,S){const C=r.getPositions(S);for(let g=0;g<C.length;g++){const I=C[g][0],v=C[g][1];for(let B=-2;B<=2;B++)for(let w=-2;w<=2;w++)B===-2||B===2||w===-2||w===2||B===0&&w===0?f.set(I+B,v+w,!0,!0):f.set(I+B,v+w,!1,!0)}}function T(f,S){const C=f.size,g=l.getEncodedBits(S);let I,v,B;for(let w=0;w<18;w++)I=Math.floor(w/3),v=w%3+C-8-3,B=(g>>w&1)===1,f.set(I,v,B,!0),f.set(v,I,B,!0)}function y(f,S,C){const g=f.size,I=u.getEncodedBits(S,C);let v,B;for(v=0;v<15;v++)B=(I>>v&1)===1,v<6?f.set(v,8,B,!0):v<8?f.set(v+1,8,B,!0):f.set(g-15+v,8,B,!0),v<8?f.set(8,g-v-1,B,!0):v<9?f.set(8,15-v-1+1,B,!0):f.set(8,15-v-1,B,!0);f.set(g-8,8,1,!0)}function P(f,S){const C=f.size;let g=-1,I=C-1,v=7,B=0;for(let w=C-1;w>0;w-=2)for(w===6&&w--;;){for(let M=0;M<2;M++)if(!f.isReserved(I,w-M)){let x=!1;B<S.length&&(x=(S[B]>>>v&1)===1),f.set(I,w-M,x),v--,v===-1&&(B++,v=7)}if(I+=g,I<0||C<=I){I-=g,g=-g;break}}}function E(f,S,C){const g=new t;C.forEach(function(M){g.put(M.mode.bit,4),g.put(M.getLength(),m.getCharCountIndicator(M.mode,f)),M.write(g)});const I=n.getSymbolTotalCodewords(f),v=a.getTotalCodewordsCount(f,S),B=(I-v)*8;for(g.getLengthInBits()+4<=B&&g.put(0,4);g.getLengthInBits()%8!==0;)g.putBit(0);const w=(B-g.getLengthInBits())/8;for(let M=0;M<w;M++)g.put(M%2?17:236,8);return p(g,f,S)}function p(f,S,C){const g=n.getSymbolTotalCodewords(S),I=a.getTotalCodewordsCount(S,C),v=g-I,B=a.getBlocksCount(S,C),w=g%B,M=B-w,x=Math.floor(g/B),$=Math.floor(v/B),rt=$+1,we=x-$,it=new c(we);let H=0;const z=new Array(B),Ee=new Array(B);let Q=0;const st=new Uint8Array(f.buffer);for(let U=0;U<B;U++){const G=U<M?$:rt;z[U]=st.slice(H,H+G),Ee[U]=it.encode(z[U]),H+=G,Q=Math.max(Q,G)}const W=new Uint8Array(g);let Ce=0,D,q;for(D=0;D<Q;D++)for(q=0;q<B;q++)D<z[q].length&&(W[Ce++]=z[q][D]);for(D=0;D<we;D++)for(q=0;q<B;q++)W[Ce++]=Ee[q][D];return W}function _(f,S,C,g){let I;if(Array.isArray(f))I=d.fromArray(f);else if(typeof f=="string"){let x=S;if(!x){const $=d.rawSplit(f);x=l.getBestVersionForData($,C)}I=d.fromString(f,x||40)}else throw new Error("Invalid data");const v=l.getBestVersionForData(I,C);if(!v)throw new Error("The amount of data is too big to be stored in a QR Code");if(!S)S=v;else if(S<v)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+v+`.
`);const B=E(S,C,I),w=n.getSymbolSize(S),M=new o(w);return h(M,S),b(M),R(M,S),y(M,C,0),S>=7&&T(M,S),P(M,B),isNaN(g)&&(g=s.getBestMask(M,y.bind(null,M,C))),s.applyMask(g,M),y(M,C,g),{modules:M,version:S,errorCorrectionLevel:C,maskPattern:g,segments:I}}return J.create=function(S,C){if(typeof S>"u"||S==="")throw new Error("No input text");let g=e.M,I,v;return typeof C<"u"&&(g=e.from(C.errorCorrectionLevel,e.M),I=l.from(C.version),v=s.from(C.maskPattern),C.toSJISFunc&&n.setToSJISFunction(C.toSJISFunc)),_(S,I,g,v)},J}var fe={},pe={},We;function ot(){return We||(We=1,function(n){function e(t){if(typeof t=="number"&&(t=t.toString()),typeof t!="string")throw new Error("Color should be defined as hex string");let o=t.slice().replace("#","").split("");if(o.length<3||o.length===5||o.length>8)throw new Error("Invalid hex color: "+t);(o.length===3||o.length===4)&&(o=Array.prototype.concat.apply([],o.map(function(i){return[i,i]}))),o.length===6&&o.push("F","F");const r=parseInt(o.join(""),16);return{r:r>>24&255,g:r>>16&255,b:r>>8&255,a:r&255,hex:"#"+o.slice(0,6).join("")}}n.getOptions=function(o){o||(o={}),o.color||(o.color={});const r=typeof o.margin>"u"||o.margin===null||o.margin<0?4:o.margin,i=o.width&&o.width>=21?o.width:void 0,s=o.scale||4;return{width:i,scale:i?4:s,margin:r,color:{dark:e(o.color.dark||"#000000ff"),light:e(o.color.light||"#ffffffff")},type:o.type,rendererOpts:o.rendererOpts||{}}},n.getScale=function(o,r){return r.width&&r.width>=o+r.margin*2?r.width/(o+r.margin*2):r.scale},n.getImageWidth=function(o,r){const i=n.getScale(o,r);return Math.floor((o+r.margin*2)*i)},n.qrToImageData=function(o,r,i){const s=r.modules.size,a=r.modules.data,c=n.getScale(s,i),l=Math.floor((s+i.margin*2)*c),u=i.margin*c,m=[i.color.light,i.color.dark];for(let d=0;d<l;d++)for(let h=0;h<l;h++){let b=(d*l+h)*4,R=i.color.light;if(d>=u&&h>=u&&d<l-u&&h<l-u){const T=Math.floor((d-u)/c),y=Math.floor((h-u)/c);R=m[a[T*s+y]?1:0]}o[b++]=R.r,o[b++]=R.g,o[b++]=R.b,o[b]=R.a}}}(pe)),pe}var Ge;function _t(){return Ge||(Ge=1,function(n){const e=ot();function t(r,i,s){r.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=s,i.width=s,i.style.height=s+"px",i.style.width=s+"px"}function o(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}n.render=function(i,s,a){let c=a,l=s;typeof c>"u"&&(!s||!s.getContext)&&(c=s,s=void 0),s||(l=o()),c=e.getOptions(c);const u=e.getImageWidth(i.modules.size,c),m=l.getContext("2d"),d=m.createImageData(u,u);return e.qrToImageData(d.data,i,c),t(m,l,u),m.putImageData(d,0,0),l},n.renderToDataURL=function(i,s,a){let c=a;typeof c>"u"&&(!s||!s.getContext)&&(c=s,s=void 0),c||(c={});const l=n.render(i,s,c),u=c.type||"image/png",m=c.rendererOpts||{};return l.toDataURL(u,m.quality)}}(fe)),fe}var ye={},Ke;function At(){if(Ke)return ye;Ke=1;const n=ot();function e(r,i){const s=r.a/255,a=i+'="'+r.hex+'"';return s<1?a+" "+i+'-opacity="'+s.toFixed(2).slice(1)+'"':a}function t(r,i,s){let a=r+i;return typeof s<"u"&&(a+=" "+s),a}function o(r,i,s){let a="",c=0,l=!1,u=0;for(let m=0;m<r.length;m++){const d=Math.floor(m%i),h=Math.floor(m/i);!d&&!l&&(l=!0),r[m]?(u++,m>0&&d>0&&r[m-1]||(a+=l?t("M",d+s,.5+h+s):t("m",c,0),c=0,l=!1),d+1<i&&r[m+1]||(a+=t("h",u),u=0)):c++}return a}return ye.render=function(i,s,a){const c=n.getOptions(s),l=i.modules.size,u=i.modules.data,m=l+c.margin*2,d=c.color.light.a?"<path "+e(c.color.light,"fill")+' d="M0 0h'+m+"v"+m+'H0z"/>':"",h="<path "+e(c.color.dark,"stroke")+' d="'+o(u,l,c.margin)+'"/>',b='viewBox="0 0 '+m+" "+m+'"',T='<svg xmlns="http://www.w3.org/2000/svg" '+(c.width?'width="'+c.width+'" height="'+c.width+'" ':"")+b+' shape-rendering="crispEdges">'+d+h+`</svg>
`;return typeof a=="function"&&a(null,T),T},ye}var Je;function Dt(){if(Je)return O;Je=1;const n=mt(),e=Tt(),t=_t(),o=At();function r(i,s,a,c,l){const u=[].slice.call(arguments,1),m=u.length,d=typeof u[m-1]=="function";if(!d&&!n())throw new Error("Callback required as last argument");if(d){if(m<2)throw new Error("Too few arguments provided");m===2?(l=a,a=s,s=c=void 0):m===3&&(s.getContext&&typeof l>"u"?(l=c,c=void 0):(l=c,c=a,a=s,s=void 0))}else{if(m<1)throw new Error("Too few arguments provided");return m===1?(a=s,s=c=void 0):m===2&&!s.getContext&&(c=a,a=s,s=void 0),new Promise(function(h,b){try{const R=e.create(a,c);h(i(R,s,c))}catch(R){b(R)}})}try{const h=e.create(a,c);l(null,i(h,s,c))}catch(h){l(h)}}return O.create=e.create,O.toCanvas=r.bind(null,t.render),O.toDataURL=r.bind(null,t.renderToDataURL),O.toString=r.bind(null,function(i,s,a){return o.render(i,a)}),O}var qt=Dt();const xt=ht(qt);class Ft{constructor(){this.database=new nt,this.camera=new ut,this.usuarios=[],this.usuariosFiltrados=[],this.paginaAtual=1,this.itensPorPagina=4,this.modoVisualizacao="grid",this.usuarioEditando=null,this.init()}async init(){try{await this.database.init(),await this.database.populateInitialData(),await this.carregarUsuarios(),this.setupCameraCallbacks(),this.setupEventListeners(),this.renderizarUsuarios(),this.atualizarEstatisticas(),this.atualizarPaginacao(),console.log("Sistema inicializado com sucesso!")}catch(e){console.error("Erro ao inicializar sistema:",e),this.mostrarToast("Erro ao inicializar sistema","error")}}async carregarUsuarios(){try{this.usuarios=await this.database.getAllUsers(),this.usuariosFiltrados=[...this.usuarios]}catch(e){console.error("Erro ao carregar usuários:",e),this.mostrarToast("Erro ao carregar usuários","error")}}setupCameraCallbacks(){this.camera.onCapture(e=>{this.processarFotoCapturada(e)}),this.camera.onQRDetected(e=>{this.processarQRDetectado(e)})}processarFotoCapturada(e){const t=new FileReader;t.onload=o=>{const r=document.getElementById("filePreview");r.innerHTML=`<img src="${o.target.result}" alt="Foto capturada">`,r.classList.add("has-image");const i=document.getElementById("foto"),s=new DataTransfer;s.items.add(e),i.files=s.files,this.mostrarToast("Foto capturada com sucesso!","success")},t.readAsDataURL(e)}processarQRDetectado(e){try{const t=JSON.parse(e);t.nome&&t.email?(document.getElementById("nome").value=t.nome||"",document.getElementById("email").value=t.email||"",document.getElementById("telefone").value=t.telefone||"",document.getElementById("cargo").value=t.cargo||"",this.mostrarToast("Dados do QR Code carregados!","success")):this.mostrarToast("QR Code não contém dados de usuário válidos","warning")}catch{this.mostrarToast("QR Code inválido","error")}}setupEventListeners(){document.getElementById("userForm").addEventListener("submit",e=>{e.preventDefault(),this.adicionarUsuario()}),document.getElementById("clearForm").addEventListener("click",()=>{this.limparFormulario()}),document.getElementById("foto").addEventListener("change",e=>{this.processarArquivo(e.target.files[0])}),document.getElementById("searchInput").addEventListener("input",e=>{this.buscarUsuarios(e.target.value)}),document.getElementById("clearSearch").addEventListener("click",()=>{document.getElementById("searchInput").value="",this.buscarUsuarios("")}),document.getElementById("cargoFilter").addEventListener("change",()=>{this.aplicarFiltros()}),document.getElementById("sortBy").addEventListener("change",()=>{this.aplicarFiltros()}),document.getElementById("gridView").addEventListener("click",()=>{this.alterarModoVisualizacao("grid")}),document.getElementById("listView").addEventListener("click",()=>{this.alterarModoVisualizacao("list")}),document.getElementById("firstPage").addEventListener("click",()=>{this.irParaPagina(1)}),document.getElementById("prevPage").addEventListener("click",()=>{this.irParaPagina(this.paginaAtual-1)}),document.getElementById("nextPage").addEventListener("click",()=>{this.irParaPagina(this.paginaAtual+1)}),document.getElementById("lastPage").addEventListener("click",()=>{const e=Math.ceil(this.usuariosFiltrados.length/this.itensPorPagina);this.irParaPagina(e)}),document.getElementById("itemsPerPageSelect").addEventListener("change",e=>{this.itensPorPagina=parseInt(e.target.value),this.paginaAtual=1,this.renderizarUsuarios(),this.atualizarPaginacao()}),document.getElementById("exportData").addEventListener("click",()=>{this.exportarDados()}),this.setupModalEventListeners()}setupModalEventListeners(){document.getElementById("modalClose").addEventListener("click",()=>{this.fecharModal("confirmModal")}),document.getElementById("modalCancel").addEventListener("click",()=>{this.fecharModal("confirmModal")}),document.getElementById("editModalClose").addEventListener("click",()=>{this.fecharModal("editModal")}),document.getElementById("editModalCancel").addEventListener("click",()=>{this.fecharModal("editModal")}),document.getElementById("editModalSave").addEventListener("click",()=>{this.salvarEdicaoUsuario()}),document.getElementById("shareModalClose").addEventListener("click",()=>{this.fecharModal("shareModal")}),document.getElementById("downloadQRBtn").addEventListener("click",()=>{this.baixarQRCode()}),document.getElementById("shareQRBtn").addEventListener("click",()=>{this.compartilharQRCode()}),document.querySelectorAll(".modal").forEach(e=>{e.addEventListener("click",t=>{t.target===e&&this.fecharModal(e.id)})})}async adicionarUsuario(){try{const e=this.obterDadosFormulario();if(!this.validarFormulario(e))return;const t=await this.database.addUser(e);this.usuarios.push(t),this.aplicarFiltros(),this.limparFormulario(),this.renderizarUsuarios(),this.atualizarEstatisticas(),this.atualizarPaginacao(),this.mostrarToast("Usuário cadastrado com sucesso!","success")}catch(e){console.error("Erro ao adicionar usuário:",e),this.mostrarToast("Erro ao cadastrar usuário","error")}}obterDadosFormulario(){const e=document.getElementById("foto");let t="https://images.pexels.com/photos/1040880/pexels-photo-1040880.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop";return e.files&&e.files[0]&&(t=URL.createObjectURL(e.files[0])),{nome:document.getElementById("nome").value.trim(),email:document.getElementById("email").value.trim(),telefone:document.getElementById("telefone").value.trim(),cargo:document.getElementById("cargo").value,foto:t}}validarFormulario(e){let t=!0;document.querySelectorAll(".error-message").forEach(i=>{i.textContent=""}),(!e.nome||e.nome.length<2)&&(document.getElementById("nomeError").textContent="Nome deve ter pelo menos 2 caracteres",t=!1);const o=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;(!e.email||!o.test(e.email))&&(document.getElementById("emailError").textContent="Email inválido",t=!1),this.usuarios.some(i=>i.email===e.email&&(!this.usuarioEditando||i.id!==this.usuarioEditando.id))&&(document.getElementById("emailError").textContent="Este email já está cadastrado",t=!1);const r=/^\(\d{2}\)\s\d{4,5}-\d{4}$/;return(!e.telefone||!r.test(e.telefone))&&(document.getElementById("telefoneError").textContent="Telefone deve estar no formato (11) 99999-9999",t=!1),e.cargo||(document.getElementById("cargoError").textContent="Selecione um cargo",t=!1),t}processarArquivo(e){if(!e)return;if(!e.type.startsWith("image/")){this.mostrarToast("Por favor, selecione apenas arquivos de imagem","error");return}if(e.size>5*1024*1024){this.mostrarToast("A imagem deve ter no máximo 5MB","error");return}const t=new FileReader;t.onload=o=>{const r=document.getElementById("filePreview");r.innerHTML=`<img src="${o.target.result}" alt="Preview da foto">`,r.classList.add("has-image")},t.readAsDataURL(e)}limparFormulario(){document.getElementById("userForm").reset();const e=document.getElementById("filePreview");e.innerHTML=`
      <iconify-icon icon="mdi:camera-plus"></iconify-icon>
      <span>Clique para adicionar foto</span>
    `,e.classList.remove("has-image"),document.querySelectorAll(".error-message").forEach(t=>{t.textContent=""})}async buscarUsuarios(e){try{e.trim()?this.usuariosFiltrados=await this.database.searchUsers(e):this.usuariosFiltrados=[...this.usuarios],this.paginaAtual=1,this.renderizarUsuarios(),this.atualizarEstatisticas(),this.atualizarPaginacao(),document.getElementById("clearSearch").classList.toggle("show",e.length>0)}catch(t){console.error("Erro ao buscar usuários:",t),this.mostrarToast("Erro na busca","error")}}aplicarFiltros(){const e=document.getElementById("cargoFilter").value,t=document.getElementById("sortBy").value;let o=[...this.usuarios];e&&(o=o.filter(i=>i.cargo===e));const r=document.getElementById("searchInput").value.trim();if(r){const i=r.toLowerCase();o=o.filter(s=>s.nome.toLowerCase().includes(i)||s.email.toLowerCase().includes(i)||s.cargo.toLowerCase().includes(i)||s.telefone.includes(r))}o.sort((i,s)=>{switch(t){case"nome":return i.nome.localeCompare(s.nome);case"email":return i.email.localeCompare(s.email);case"cargo":return i.cargo.localeCompare(s.cargo);case"data":return new Date(s.dataRegistro)-new Date(i.dataRegistro);default:return 0}}),this.usuariosFiltrados=o,this.paginaAtual=1,this.renderizarUsuarios(),this.atualizarEstatisticas(),this.atualizarPaginacao()}alterarModoVisualizacao(e){this.modoVisualizacao=e,document.getElementById("gridView").classList.toggle("active",e==="grid"),document.getElementById("listView").classList.toggle("active",e==="list");const t=document.getElementById("usuariosContainer");t.className=e==="grid"?"usuarios-grid":"usuarios-list",this.renderizarUsuarios()}renderizarUsuarios(){const e=document.getElementById("usuariosContainer"),t=document.getElementById("emptyState");if(this.usuariosFiltrados.length===0){e.innerHTML="",t.style.display="block";return}t.style.display="none";const o=(this.paginaAtual-1)*this.itensPorPagina,r=o+this.itensPorPagina,i=this.usuariosFiltrados.slice(o,r);e.innerHTML=i.map((s,a)=>`
        <div class="usuario-card ${this.modoVisualizacao==="list"?"list-view":""}" style="animation-delay: ${a*.1}s">
          <img src="${s.foto}" alt="${s.nome}" onerror="this.src='https://images.pexels.com/photos/1040880/pexels-photo-1040880.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop'">
          <div class="usuario-info">
            <h3>${s.nome}</h3>
            <p><iconify-icon icon="mdi:email"></iconify-icon> ${s.email}</p>
            <p><iconify-icon icon="mdi:phone"></iconify-icon> ${s.telefone}</p>
            <span class="cargo">${s.cargo}</span>
          </div>
          <div class="usuario-actions">
            <button class="action-btn edit-btn" onclick="userSystem.editarUsuario(${s.id})">
              <iconify-icon icon="mdi:pencil"></iconify-icon> Editar
            </button>
            <button class="action-btn share-btn" onclick="userSystem.compartilharUsuario(${s.id})">
              <iconify-icon icon="mdi:share"></iconify-icon> Compartilhar
            </button>
            <button class="action-btn remove-btn" onclick="userSystem.confirmarRemocao(${s.id})">
              <iconify-icon icon="mdi:delete"></iconify-icon> Remover
            </button>
          </div>
        </div>
      `).join("")}atualizarEstatisticas(){const e=this.usuarios.length,t=new Date().toDateString(),o=this.usuarios.filter(i=>new Date(i.dataRegistro).toDateString()===t).length,r=this.usuariosFiltrados.length;this.animarNumero("totalUsers",e),this.animarNumero("newUsersToday",o),this.animarNumero("filteredUsers",r)}animarNumero(e,t){const o=document.getElementById(e),r=parseInt(o.textContent)||0;if(r===t)return;const s=(t-r)/(500/16);let a=r;const c=()=>{a+=s,s>0&&a>=t||s<0&&a<=t?o.textContent=t:(o.textContent=Math.round(a),requestAnimationFrame(c))};c()}atualizarPaginacao(){const e=Math.ceil(this.usuariosFiltrados.length/this.itensPorPagina);document.getElementById("firstPage").disabled=this.paginaAtual===1,document.getElementById("prevPage").disabled=this.paginaAtual===1,document.getElementById("nextPage").disabled=this.paginaAtual===e,document.getElementById("lastPage").disabled=this.paginaAtual===e;const t=document.getElementById("pageNumbers");t.innerHTML="";const o=5;let r=Math.max(1,this.paginaAtual-Math.floor(o/2)),i=Math.min(e,r+o-1);i-r<o-1&&(r=Math.max(1,i-o+1));for(let c=r;c<=i;c++){const l=document.createElement("button");l.textContent=c,l.classList.toggle("active",c===this.paginaAtual),l.addEventListener("click",()=>this.irParaPagina(c)),t.appendChild(l)}const s=(this.paginaAtual-1)*this.itensPorPagina+1,a=Math.min(this.paginaAtual*this.itensPorPagina,this.usuariosFiltrados.length);document.getElementById("pageInfo").textContent=`Página ${this.paginaAtual} de ${e} (${s}-${a} de ${this.usuariosFiltrados.length})`}irParaPagina(e){const t=Math.ceil(this.usuariosFiltrados.length/this.itensPorPagina);e<1||e>t||(this.paginaAtual=e,this.renderizarUsuarios(),this.atualizarPaginacao(),document.querySelector(".users-section").scrollIntoView({behavior:"smooth",block:"start"}))}async editarUsuario(e){try{const t=this.usuarios.find(o=>o.id===e);if(!t)return;this.usuarioEditando=t,document.getElementById("editUserId").value=t.id,document.getElementById("editNome").value=t.nome,document.getElementById("editEmail").value=t.email,document.getElementById("editTelefone").value=t.telefone,document.getElementById("editCargo").value=t.cargo,this.abrirModal("editModal")}catch(t){console.error("Erro ao editar usuário:",t),this.mostrarToast("Erro ao carregar dados do usuário","error")}}async salvarEdicaoUsuario(){try{const e=parseInt(document.getElementById("editUserId").value),t={nome:document.getElementById("editNome").value.trim(),email:document.getElementById("editEmail").value.trim(),telefone:document.getElementById("editTelefone").value.trim(),cargo:document.getElementById("editCargo").value};await this.database.updateUser(e,t);const o=this.usuarios.findIndex(r=>r.id===e);o!==-1&&Object.assign(this.usuarios[o],t),this.aplicarFiltros(),this.renderizarUsuarios(),this.fecharModal("editModal"),this.usuarioEditando=null,this.mostrarToast("Usuário atualizado com sucesso!","success")}catch(e){console.error("Erro ao salvar usuário:",e),this.mostrarToast("Erro ao salvar alterações","error")}}confirmarRemocao(e){const t=this.usuarios.find(r=>r.id===e);if(!t)return;document.getElementById("modalTitle").textContent="Confirmar Remoção",document.getElementById("modalMessage").textContent=`Tem certeza que deseja remover o usuário "${t.nome}"? Esta ação não pode ser desfeita.`;const o=document.getElementById("modalConfirm");o.onclick=()=>this.removerUsuario(e),this.abrirModal("confirmModal")}async removerUsuario(e){try{await this.database.deleteUser(e),this.usuarios=this.usuarios.filter(t=>t.id!==e),this.aplicarFiltros(),this.renderizarUsuarios(),this.atualizarEstatisticas(),this.atualizarPaginacao(),this.fecharModal("confirmModal"),this.mostrarToast("Usuário removido com sucesso!","success")}catch(t){console.error("Erro ao remover usuário:",t),this.mostrarToast("Erro ao remover usuário","error")}}async compartilharUsuario(e){try{const t=this.usuarios.find(i=>i.id===e);if(!t)return;document.getElementById("shareUserName").textContent=t.nome,document.getElementById("shareUserDetails").textContent=`${t.cargo} • ${t.email}`;const o={nome:t.nome,email:t.email,telefone:t.telefone,cargo:t.cargo},r=document.getElementById("qrCodeCanvas");await xt.toCanvas(r,JSON.stringify(o),{width:200,margin:2,color:{dark:"#000000",light:"#FFFFFF"}}),this.abrirModal("shareModal")}catch(t){console.error("Erro ao gerar QR code:",t),this.mostrarToast("Erro ao gerar QR code","error")}}baixarQRCode(){const e=document.getElementById("qrCodeCanvas"),t=document.createElement("a");t.download="qr-code-usuario.png",t.href=e.toDataURL(),t.click(),this.mostrarToast("QR Code baixado!","success")}async compartilharQRCode(){try{document.getElementById("qrCodeCanvas").toBlob(async t=>{if(navigator.share){const o=new File([t],"qr-code-usuario.png",{type:"image/png"});await navigator.share({title:"QR Code do Usuário",text:"Compartilhando dados do usuário via QR Code",files:[o]})}else{const o=new ClipboardItem({"image/png":t});await navigator.clipboard.write([o]),this.mostrarToast("QR Code copiado para a área de transferência!","success")}})}catch(e){console.error("Erro ao compartilhar:",e),this.mostrarToast("Erro ao compartilhar QR Code","error")}}exportarDados(){try{const e=this.usuariosFiltrados.map(i=>({Nome:i.nome,Email:i.email,Telefone:i.telefone,Cargo:i.cargo,"Data de Registro":new Date(i.dataRegistro).toLocaleDateString("pt-BR")})),t=this.converterParaCSV(e),o=new Blob([t],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");r.href=URL.createObjectURL(o),r.download=`usuarios_${new Date().toISOString().split("T")[0]}.csv`,r.click(),this.mostrarToast("Dados exportados com sucesso!","success")}catch(e){console.error("Erro ao exportar dados:",e),this.mostrarToast("Erro ao exportar dados","error")}}converterParaCSV(e){if(e.length===0)return"";const t=Object.keys(e[0]);return"\uFEFF"+[t.join(","),...e.map(r=>t.map(i=>`"${r[i]||""}"`).join(","))].join(`
`)}abrirModal(e){const t=document.getElementById(e);t.classList.add("show");const o=t.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');o.length>0&&o[0].focus()}fecharModal(e){document.getElementById(e).classList.remove("show")}mostrarToast(e,t="info"){const o=document.getElementById("toastContainer"),r=document.createElement("div");r.className=`toast ${t}`;const i={success:"mdi:check-circle",error:"mdi:alert-circle",warning:"mdi:alert",info:"mdi:information"};r.innerHTML=`
      <iconify-icon icon="${i[t]||i.info}"></iconify-icon>
      <div class="toast-content">
        <div class="toast-title">${e}</div>
      </div>
      <button class="toast-close">
        <iconify-icon icon="mdi:close"></iconify-icon>
      </button>
    `,o.appendChild(r),setTimeout(()=>{r.style.opacity="0",r.style.transform="translateX(100%)",setTimeout(()=>{o.contains(r)&&o.removeChild(r)},300)},5e3),r.querySelector(".toast-close").addEventListener("click",()=>{r.style.opacity="0",r.style.transform="translateX(100%)",setTimeout(()=>{o.contains(r)&&o.removeChild(r)},300)})}}document.addEventListener("DOMContentLoaded",()=>{window.userSystem=new Ft});var Ye;(Ye=document.getElementById("telefone"))==null||Ye.addEventListener("input",function(n){let e=n.target.value.replace(/\D/g,"");e.length<=11&&(e=e.replace(/(\d{2})(\d{4,5})(\d{4})/,"($1) $2-$3"),n.target.value=e)});var Xe;(Xe=document.getElementById("editTelefone"))==null||Xe.addEventListener("input",function(n){let e=n.target.value.replace(/\D/g,"");e.length<=11&&(e=e.replace(/(\d{2})(\d{4,5})(\d{4})/,"($1) $2-$3"),n.target.value=e)});
